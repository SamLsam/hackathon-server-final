Доброго времени суток.

Язык программирования - Python 3.7.12
IDE - jupyterlab (файлы ipynb)

Библиотеки:
numpy 1.21.5
pandas 1.3.4 (для excel ипользовал openpyxl внутри pandas)
darts (https://unit8co.github.io/darts/index.html#id3) 0.17.1 (Install core + AutoARIMA: pip install "u8darts[pmdarima]", lightgbm в core)
scikit-learn 1.0.2
matplotlib 3.5.1
seaborn 0.11.2
optuna 2.10.0

Файлов с кодом столько, сколько БЕ, каждый файл соответствует своей БЕ.

Структура каждого похожа. Самое большое количество комментариев в файле BU0. Ссылка на covariates-признаки внутри. По сути -
так обозвали регрессоры. Отличие - какие можно использовать из будущего, а какие нет. В презентации чуть подробнее освещаю момент.

Ответы из всех файлов train_N_ans_play_off собираются в файле predictor.ipynb
Файлы train_N_ans_ts.csv - файлы временных рядов из отборов, не cumsum.
========================================================================================================================================================
Невидимая часть моего маленького айсберга:

Optuna'ой считал сначала 300 итераций, потом время поджимать стало, сделал 100 итераций. Не факт, что лучше гридсерча, но был 
свой бойлерплейт для классификации под рукой, оставалось только обрезать лишнее. 
К тому же, параметры модели Darts (lags_future_covariates=(61 - смотрим в прошлое на 60 дней + 1 день "сегодня", 31 - в будущее)) взял условно,
хотя их тоже можно потюнить, получить поточнее результат.

Что еще пробовал: чистый lightgbm с предсказанием на 1 день вперед (видимо прикладывать ее не буду) для BU5 с доп. регрессорами - 
после checkpoint 1 Мария (извините, не знаю отчества) Северцева сообщила, что 1 день вперед мало, начальный milestone 7 дней, базовый 
milestone 30 дней (месяц). 30 дней уже даст казначейству ощутимый размах. Вот в этой модели как раз схему "таргет прошлого - регрессор
настоящего" не использовал.

Пробовал tft, rnn, brnn (все из darts, хотя он по факту для них обертка, сами они тянут pytorch) - почему-то совсем не сходятся,
где-то что-то упускаю; и вместо предикта получаю простопрямую с значение ноль. Бойлерплейта под рукой нет для них - плюнул, и так с ними
время только потерял. Может кто из участников "завел" модель - это было бы круто.

Для БЕ 5 пробовал добавлять тех. индикаторы MA (7, 14, 30) [https://en.wikipedia.org/wiki/Moving_average] для доп. данных (past_covariates) -
не улучшило модель. Но почти уверен, что может улучшить, если добавить их для таргета. Не успел реализовать и проверить. Вообще стоит "погонять"
индикаторы тех. анализа, может какой-то и выстрелит, несмотря на то, что у нас таргет имеет разреженную природу. Надеюсь, кто-то из 
участников это посмотрел.

По использованию предсказанного таргета в качестве регрессора в Darts:
output_chunk_length = 1 - предсказываем на 1 день вперед. Его же кормим (сама модель и кормит) на вход для использования в предикте следующего дня.
И так итеративно до N: model.predict (n=N) - где N это желаемый временной интервал с заданной частотой. LightGBM - 1D, AArima - 7D

========================================================================================================================================================
Мысли вслух:

Вообще, я бы пробовал копать здесь:
1) Найти и понять информацию, из каких составляющих формируется сумма таргета (в абсолютных значениях). Т.е. как бы вместе с суммой пройти все шаги
ее хождения: от начала ее формирования от физического источника до момента выхода к контрагенту.
2) Платежные дни. Они же имеют под собой человеческую природу - может стоит посмотреть прямо на местах, как эти дни (которые не основные платежные, а срочные) 
"формируются". Посмотреть причины их появления как отдельная DS задача.

Всё это требует работы вместе с казначейством и с энергетиками, тут может стать вопрос о доступе к данным (разглашаемость данных, особенно у казначейства,
конечно).

3) Может быть есть такие БЕ, у которых высокая платежная дисциплина. На таких БЕ могут хорошо отработать модели и без доп. данных.

P.S.

Привет!
В преддверии финала хотели бы поделиться обратной связью от экспертов:
Всем спасибо за проделанную работу и предоставленные решения. 
Мы решили выдать данные за 1 квартал 21 года, чтобы у вас была возможность самим оценить работу моделей и скорректировать некоторые моменты. 
По окончании данного этапа мы ожидаем от вас реализацию ваших идей, прогноз на 2 квартал 21 года, а также твердый и четкий ответ, на вопрос о том,
могут ли предоставленные дополнительные данные о БЕ номер 3 и 5 помочь улучшить точность моделей. 
Пожалуйста, по итогам своей работы предоставьте файл с прогнозами в виде кумулятивных сумм, аналогично тому, как это представлено в файле
с объяснением подсчета метрики.

Твердо и четко, твердо и четко ....
Да, точно!
https://www.youtube.com/watch?v=hMM5bZu5KEs
Отсылка 10/10. Как раз в задаче ликвидности.